# ๐ ุฏููู ุงูุญุตูู ุนูู ููุงุชูุญ Stripe API - ุฎุทูุฉ ุจุฎุทูุฉ

## ๐ ุงููุชุทูุจุงุช

- ุจุฑูุฏ ุฅููุชุฑููู
- ุงุชุตุงู ุจุงูุฅูุชุฑูุช
- 5 ุฏูุงุฆู ูู ููุชู

---

## ๐ ุงูุฎุทูุงุช

### **ุงูุฎุทูุฉ 1: ุฅูุดุงุก ุญุณุงุจ Stripe**

#### ุฃ) ุงุฐูุจ ุฅูู ุตูุญุฉ ุงูุชุณุฌูู:

```
https://dashboard.stripe.com/register
```

#### ุจ) ุงููุฃ ุงูุจูุงูุงุช ุงููุทููุจุฉ:

- **Email:** ุจุฑูุฏู ุงูุฅููุชุฑููู
- **Full name:** ุงุณูู ุงููุงูู
- **Password:** ูููุฉ ูุฑูุฑ ูููุฉ
- **Country:** ุงุฎุชุฑ ุจูุฏู (ูุตุฑ - Egypt)

#### ุฌ) ุงุถุบุท ุนูู "Create account"

#### ุฏ) ุชุญูู ูู ุจุฑูุฏู ุงูุฅููุชุฑููู ููุนูู ุงูุญุณุงุจ

---

### **ุงูุฎุทูุฉ 2: ุชุณุฌูู ุงูุฏุฎูู**

#### ุงุฐูุจ ุฅูู:

```
https://dashboard.stripe.com/login
```

#### ุฃุฏุฎู:

- ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
- ูููุฉ ุงููุฑูุฑ

---

### **ุงูุฎุทูุฉ 3: ุงูุญุตูู ุนูู ููุงุชูุญ API**

#### ุฃ) ุจุนุฏ ุชุณุฌูู ุงูุฏุฎููุ ุงุฐูุจ ุฅูู:

```
Developers โ API keys
```

ุฃู ูุจุงุดุฑุฉ:

```
https://dashboard.stripe.com/test/apikeys
```

#### ุจ) ุณุชุฌุฏ ููุชุงุญูู:

##### **1. Publishable key** (ููู Frontend)

```
pk_test_51xxxxxxxxxxxxxxxxxxxxx
```

- ูุฐุง ุงูููุชุงุญ **ุขูู** ููุงุณุชุฎุฏุงู ูู Frontend
- ูุจุฏุฃ ุจู `pk_test_` (ููุงุฎุชุจุงุฑ)
- ุงูุณุฎู ูุงููุงู

##### **2. Secret key** (ููู Backend)

```
sk_test_51xxxxxxxxxxxxxxxxxxxxx
```

- ูุฐุง ุงูููุชุงุญ **ุณุฑู** ููุง ูุฌุจ ูุดุงุฑูุชู
- ูุจุฏุฃ ุจู `sk_test_` (ููุงุฎุชุจุงุฑ)
- ุงุถุบุท ุนูู "Reveal test key" ูุฅุธูุงุฑู
- ุงูุณุฎู ูุงููุงู

---

### **ุงูุฎุทูุฉ 4: ุฅุถุงูุฉ ุงูููุงุชูุญ ูููุดุฑูุน**

#### ุฃ) Backend (.env):

```env
# ูู ููู: d:\projects\project\backend\.env
STRIPE_SECRET_KEY=sk_test_51xxxxxxxxxxxxxxxxxxxxx
```

#### ุจ) Frontend (.env.local):

```env
# ูู ููู: d:\projects\project\frontend\.env.local
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_51xxxxxxxxxxxxxxxxxxxxx
```

---

### **ุงูุฎุทูุฉ 5: ุฅุนุงุฏุฉ ุชุดุบูู ุงูุฎูุงุฏู**

#### ุฃ) ุฃููู ุงูุฎูุงุฏู ุงูุญุงููุฉ:

```bash
# ุงุถุบุท Ctrl+C ูู ูู terminal
```

#### ุจ) ุดุบูู Backend:

```bash
cd d:\projects\project\backend
npm run dev
```

#### ุฌ) ุดุบูู Frontend:

```bash
cd d:\projects\project\frontend
npm run dev
```

---

## โ ุงูุชุญูู ูู ุงูุชุซุจูุช

### ุงุฎุชุจุฑ ูุธุงู ุงูุฏูุน:

1. ุงูุชุญ ุงููุชุตูุญ:

```
http://localhost:3000
```

2. ุณุฌู ุฏุฎูู ุฃู ุฃูุดุฆ ุญุณุงุจ

3. ุฃูุดุฆ ุชุญุฏู ุฌุฏูุฏ

4. ุงุฐูุจ ูุตูุญุฉ ุงูุฏูุน:

```
http://localhost:3000/challenges/payment?challengeId=xxx&amount=100
```

5. ุงุณุชุฎุฏู ุจุทุงูุฉ ุงุฎุชุจุงุฑ:

```
Card Number: 4242 4242 4242 4242
Expiry: 12/34 (ุฃู ุชุงุฑูุฎ ูุณุชูุจูู)
CVC: 123 (ุฃู 3 ุฃุฑูุงู)
ZIP: 12345 (ุฃู 5 ุฃุฑูุงู)
```

6. ุงุถุบุท "Pay"

7. ุฅุฐุง ูุฌุญ ุงูุฏูุน โ **ุชู ุงูุชุซุจูุช ุจูุฌุงุญ!** โ

---

## ๐ง ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ูุดููุฉ: "Stripe is not defined"

**ุงูุณุจุจ:** ุงูููุชุงุญ ุบูุฑ ููุฌูุฏ ูู Frontend
**ุงูุญู:**

```bash
# ุชุฃูุฏ ูู ูุฌูุฏ ุงูููู:
d:\projects\project\frontend\.env.local

# ูุฃูู ูุญุชูู ุนูู:
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_xxx
```

### ูุดููุฉ: "Payment intent creation failed"

**ุงูุณุจุจ:** ุงูููุชุงุญ ุบูุฑ ููุฌูุฏ ูู Backend
**ุงูุญู:**

```bash
# ุชุฃูุฏ ูู ูุฌูุฏ ุงูููู:
d:\projects\project\backend\.env

# ูุฃูู ูุญุชูู ุนูู:
STRIPE_SECRET_KEY=sk_test_xxx
```

### ูุดููุฉ: "Invalid API key"

**ุงูุณุจุจ:** ุงูููุชุงุญ ุฎุงุทุฆ ุฃู ููุชูู
**ุงูุญู:**

- ุชุฃูุฏ ูู ูุณุฎ ุงูููุชุงุญ ูุงููุงู
- ุชุฃูุฏ ูู ุงุณุชุฎุฏุงู ููุงุชูุญ Test (ุชุจุฏุฃ ุจู `pk_test_` ู `sk_test_`)
- ุฌุฑุจ ุฅูุดุงุก ููุงุชูุญ ุฌุฏูุฏุฉ ูู Dashboard

---

## ๐ฑ Webhook (ุงุฎุชูุงุฑู ููุชุทููุฑ)

### ุฅุฐุง ุฃุฑุฏุช ุงุฎุชุจุงุฑ Webhooks ูุญููุงู:

#### 1. ุซุจูุช Stripe CLI:

```bash
# Windows
scoop install stripe

# ุฃู ุญููู ูู:
https://github.com/stripe/stripe-cli/releases
```

#### 2. ุณุฌู ุฏุฎูู:

```bash
stripe login
```

#### 3. ุงุณุชูุน ููุฃุญุฏุงุซ:

```bash
stripe listen --forward-to localhost:5000/api/v1/payments/webhook
```

#### 4. ุงูุณุฎ ุงูู webhook secret:

```
whsec_xxxxxxxxxxxxx
```

#### 5. ุฃุถูู ููู Backend:

```env
STRIPE_WEBHOOK_SECRET=whsec_xxxxxxxxxxxxx
```

---

## ๐ฏ ุงูุฎูุงุตุฉ

ุจุนุฏ ุงุชุจุงุน ูุฐู ุงูุฎุทูุงุชุ ุณูููู ูุฏูู:

โ ุญุณุงุจ Stripe ูุดุท
โ ููุงุชูุญ API (Publishable & Secret)
โ ูุธุงู ุฏูุน ูุนูู ุจุงููุงูู
โ ุงููุฏุฑุฉ ุนูู ุงุฎุชุจุงุฑ ุงููุฏููุนุงุช

---

## ๐ ุงููุณุงุนุฏุฉ

ุฅุฐุง ูุงุฌูุช ุฃู ูุดููุฉ:

1. ุฑุงุฌุน `PAYMENT_SYSTEM_GUIDE.md`
2. ุชุญูู ูู console ูู ุงููุชุตูุญ (F12)
3. ุชุญูู ูู logs ูู Backend terminal
4. ุฑุงุฌุน Stripe Dashboard โ Logs

---

**ุชุงุฑูุฎ ุงูุฅูุดุงุก:** 2025-12-19  
**ุงูุญุงูุฉ:** โ ุฌุงูุฒ ููุงุณุชุฎุฏุงู
